{"ast":null,"code":"import _Symbol$toPrimitive from \"@babel/runtime-corejs2/core-js/symbol/to-primitive\";\nimport _toConsumableArray from \"@babel/runtime-corejs2/helpers/esm/toConsumableArray\";\nimport _objectWithoutProperties from \"@babel/runtime-corejs2/helpers/esm/objectWithoutProperties\";\nimport _objectSpread from \"@babel/runtime-corejs2/helpers/esm/objectSpread\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nvar _jsxFileName = \"/Users/crocslut/Desktop/Git/zpc/components/SidebarMenu/SidebarMenu.js\";\n\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return typeof key === \"symbol\" ? key : String(key); }\n\nfunction _toPrimitive(input, hint) { if (typeof input !== \"object\" || input === null) return input; var prim = input[_Symbol$toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (typeof res !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { withRouter } from 'next/router';\nimport _ from 'lodash';\nimport classNames from 'classnames';\nimport { withPageConfig } from './../Layout/withPageConfig';\nimport Common from './../../core/common';\nimport { MenuContext } from './MenuContext';\n\nvar SidebarMenu =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(SidebarMenu, _React$Component);\n\n  function SidebarMenu(props) {\n    var _this;\n\n    _classCallCheck(this, SidebarMenu);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(SidebarMenu).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_this), \"containerRef\", React.createRef());\n\n    _this.state = {\n      entries: _this.entries = {}\n    };\n    return _this;\n  }\n\n  _createClass(SidebarMenu, [{\n    key: \"addEntry\",\n    value: function addEntry(entry) {\n      this.setState({\n        entries: this.entries = _objectSpread({}, this.entries, _defineProperty({}, entry.id, _objectSpread({\n          open: false,\n          active: false\n        }, entry)))\n      });\n    }\n  }, {\n    key: \"updateEntry\",\n    value: function updateEntry(id, stateMods) {\n      this.setState({\n        entries: this.entries = _objectSpread({}, this.state.entries, _defineProperty({}, id, _objectSpread({}, this.state.entries[id], stateMods)))\n      });\n    }\n  }, {\n    key: \"removeEntry\",\n    value: function removeEntry(id) {\n      // eslint-disable-next-line no-unused-vars\n      var _this$state$entries = this.state.entries,\n          toRemove = _this$state$entries[id],\n          rest = _objectWithoutProperties(_this$state$entries, [id].map(_toPropertyKey));\n\n      this.setState({\n        entries: this.entries = rest\n      });\n    }\n  }, {\n    key: \"setActiveEntries\",\n    value: function setActiveEntries() {\n      var _this2 = this;\n\n      var openActive = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n\n      var activeId = function activeId(childEntry, entries) {\n        var previous = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [];\n\n        if (childEntry.parentId) {\n          var parentEntry = entries[childEntry.parentId];\n          var activeIds = [].concat(_toConsumableArray(previous), [parentEntry.id]);\n          return activeId(parentEntry, entries, activeIds);\n        }\n\n        return previous;\n      };\n\n      var activeChild = _.find(this.state.entries, function (entry) {\n        var pathname = _this2.props.router.pathname;\n        var noTailSlashLocation = pathname[pathname.length - 1] === '/' && pathname.length > 1 ? pathname.replace(/\\/$/, '') : pathname;\n        return entry.exact ? entry.url === noTailSlashLocation : _.includes(noTailSlashLocation, entry.url);\n      });\n\n      if (activeChild) {\n        var activeEntries = [].concat(_toConsumableArray(activeId(activeChild, this.entries)), [activeChild.id]);\n        this.setState({\n          entries: this.entries = _.mapValues(this.entries, function (entry) {\n            var isActive = _.includes(activeEntries, entry.id);\n\n            return _objectSpread({}, entry, {\n              active: isActive,\n              open: openActive ? !entry.url && isActive : entry.open\n            });\n          })\n        });\n      }\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this3 = this;\n\n      this.sidebarAnimation = new Common.SideMenuAnimate();\n      this.sidebarAnimation.assignParentElement(this.containerRef.current);\n      setTimeout(function () {\n        _this3.setActiveEntries(true);\n      }, 0);\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps) {\n      if (this.props.router.pathname !== prevProps.router.pathname) {\n        this.setActiveEntries();\n      }\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      if (this.sidebarAnimation) {\n        this.sidebarAnimation.destroy();\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this4 = this;\n\n      var isSlim = this.props.slim || this.props.pageConfig.sidebarSlim && this.props.pageConfig.sidebarCollapsed && (this.props.pageConfig.screenSize === 'lg' || this.props.pageConfig.screenSize === 'xl');\n      var sidebarMenuClass = classNames('sidebar-menu', {\n        'sidebar-menu--slim': isSlim,\n        'sidebar-menu--disabled': this.props.disabled\n      });\n      return React.createElement(MenuContext.Provider, {\n        value: {\n          entries: this.state.entries,\n          addEntry: this.addEntry.bind(this),\n          updateEntry: this.updateEntry.bind(this),\n          removeEntry: this.removeEntry.bind(this)\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 137\n        },\n        __self: this\n      }, React.createElement(\"ul\", {\n        className: sidebarMenuClass,\n        ref: this.containerRef,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 145\n        },\n        __self: this\n      }, React.Children.map(this.props.children, function (child) {\n        return React.createElement(MenuContext.Consumer, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 148\n          },\n          __self: this\n        }, function (ctx) {\n          return React.cloneElement(child, _objectSpread({}, ctx, {\n            currentUrl: _this4.props.router.pathname,\n            slim: isSlim\n          }));\n        });\n      })));\n    }\n  }]);\n\n  return SidebarMenu;\n}(React.Component);\n\n_defineProperty(SidebarMenu, \"propTypes\", {\n  children: PropTypes.node,\n  currentUrl: PropTypes.string,\n  slim: PropTypes.bool,\n  router: PropTypes.object,\n  pageConfig: PropTypes.object,\n  disabled: PropTypes.bool\n});\n\nvar RouterSidebarMenu = withPageConfig(withRouter(SidebarMenu));\nexport { RouterSidebarMenu as SidebarMenu };","map":{"version":3,"sources":["/Users/crocslut/Desktop/Git/zpc/components/SidebarMenu/SidebarMenu.js"],"names":["React","PropTypes","withRouter","_","classNames","withPageConfig","Common","MenuContext","SidebarMenu","props","createRef","state","entries","entry","setState","id","open","active","stateMods","toRemove","rest","openActive","activeId","childEntry","previous","parentId","parentEntry","activeIds","activeChild","find","pathname","router","noTailSlashLocation","length","replace","exact","url","includes","activeEntries","mapValues","isActive","sidebarAnimation","SideMenuAnimate","assignParentElement","containerRef","current","setTimeout","setActiveEntries","prevProps","destroy","isSlim","slim","pageConfig","sidebarSlim","sidebarCollapsed","screenSize","sidebarMenuClass","disabled","addEntry","bind","updateEntry","removeEntry","Children","map","children","child","ctx","cloneElement","currentUrl","Component","node","string","bool","object","RouterSidebarMenu"],"mappings":"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","sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport { withRouter } from 'next/router';\nimport _ from 'lodash';\nimport classNames from 'classnames';\n\nimport { withPageConfig } from './../Layout/withPageConfig'\nimport Common from './../../core/common';\nimport { MenuContext } from './MenuContext';\n\nclass SidebarMenu extends React.Component {\n    static propTypes = {\n        children: PropTypes.node,\n        currentUrl: PropTypes.string,\n        slim: PropTypes.bool,\n        router: PropTypes.object,\n        pageConfig: PropTypes.object,\n        disabled: PropTypes.bool\n    }\n\n    containerRef = React.createRef();\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            entries: this.entries = { }\n        };\n    }\n\n    addEntry(entry) {\n        this.setState({\n            entries: this.entries = {\n                ...this.entries,\n                [entry.id]: {\n                    open: false,\n                    active: false,\n                    ...entry\n                }\n            }\n        });\n    }\n\n    updateEntry(id, stateMods) {\n        this.setState({\n            entries: this.entries = {\n                ...this.state.entries,\n                [id]: {\n                    ...this.state.entries[id],\n                    ...stateMods\n                }\n            }\n        });\n    }\n\n    removeEntry(id) {\n        // eslint-disable-next-line no-unused-vars\n        const { [id]: toRemove, ...rest } = this.state.entries;\n        this.setState({ entries: this.entries = rest });\n    }\n\n    setActiveEntries(openActive = false) {\n        const activeId = (childEntry, entries, previous = []) => {\n            if (childEntry.parentId) {\n                const parentEntry = entries[childEntry.parentId];\n                const activeIds = [...previous, parentEntry.id];\n                return activeId(parentEntry, entries, activeIds);\n            }\n            return previous;\n        }\n        \n        const activeChild = _.find(this.state.entries, (entry) => {\n            const { pathname } = this.props.router;\n\n            const noTailSlashLocation = pathname[pathname.length - 1] === '/' && pathname.length > 1 ?\n                pathname.replace(/\\/$/, '') : pathname;\n\n            return entry.exact ?\n                entry.url === noTailSlashLocation :\n                _.includes(noTailSlashLocation, entry.url)\n        });\n\n        if (activeChild) {\n            const activeEntries = [...activeId(activeChild, this.entries), activeChild.id];\n\n            this.setState({\n                entries: this.entries = _.mapValues(this.entries, (entry) => {\n                    const isActive = _.includes(activeEntries, entry.id);\n\n                    return {\n                        ...entry,\n                        active: isActive,\n                        open: openActive ? (!entry.url && isActive) : entry.open\n                    };\n                })\n            });\n        }\n    }\n\n    componentDidMount() {\n        this.sidebarAnimation = new Common.SideMenuAnimate();\n        this.sidebarAnimation.assignParentElement(\n            this.containerRef.current\n        ); \n        \n        setTimeout(() => {\n            this.setActiveEntries(true);\n        }, 0);\n    }\n\n    componentDidUpdate(prevProps) {\n        if (this.props.router.pathname !== prevProps.router.pathname) {\n            this.setActiveEntries();\n        }\n    }\n\n    componentWillUnmount() {\n        if (this.sidebarAnimation) {\n            this.sidebarAnimation.destroy();\n        }\n    }\n\n    render() {\n        const isSlim = this.props.slim || (\n            this.props.pageConfig.sidebarSlim &&\n            this.props.pageConfig.sidebarCollapsed && (\n                this.props.pageConfig.screenSize === 'lg' ||\n                this.props.pageConfig.screenSize === 'xl'\n            )\n        );\n        const sidebarMenuClass = classNames('sidebar-menu', {\n            'sidebar-menu--slim': isSlim,\n            'sidebar-menu--disabled': this.props.disabled\n        });\n\n        return (\n            <MenuContext.Provider\n                value={{\n                    entries: this.state.entries,\n                    addEntry: this.addEntry.bind(this),\n                    updateEntry: this.updateEntry.bind(this),\n                    removeEntry: this.removeEntry.bind(this)\n                }}\n            >\n            <ul className={ sidebarMenuClass } ref={ this.containerRef }>\n            {\n                React.Children.map(this.props.children, (child) =>\n                    <MenuContext.Consumer>\n                    {\n                        (ctx) => React.cloneElement(child, {\n                            ...ctx,\n                            currentUrl: this.props.router.pathname,\n                            slim: isSlim\n                        })\n                    }\n                    </MenuContext.Consumer>\n                )\n            }\n            </ul>\n            </MenuContext.Provider>\n        )\n    }\n}\n\nconst RouterSidebarMenu = withPageConfig(withRouter(SidebarMenu));\n\nexport {\n    RouterSidebarMenu as SidebarMenu\n};\n"]},"metadata":{},"sourceType":"module"}